<!DOCTYPE html>
<html xmlns:th = "http://thymeleaf.org"
	  xmlns:sec = "https://ww.thymeleaf.org/extras/spring-security">
<head>
<!-- <title th:text="${party.name}"></title> -->
<title th:text ="${party.partyName}"></title>

<link rel= "stylesheet" th:href="@{/css/party.css}">

</head>
<body>

	<div class="table">
		<table>
		<thead>	
			<tr>
				<th class = "party-name" th:text = "${party.partyName}"><th>
			</tr>
			<tr>
				<th th:text = "${dm.firstName}">
			</tr>
		</thead>
		<thead>	
			<tr>
				<th>Player<th>
				<th>Character<th>
				<th>Experience<th>
				<th>Alignment<th>
				<th>Coins<th>
			</tr>
		</thead>
		<tbody>
			<tr th:each="onePartyPlayer : ${players}">
				<td th:text = "${onePartyPlayer.firstName}"></td>
			    <td th:text = "${onePartyPlayer?.characterName}"></td>
				<td th:text = "${onePartyPlayer?.experience}"></td>
				<td><form th:action = "@{/add-xp/{characterName}/{partyId} (characterName = ${onePartyPlayer.characterName}, partyId = ${party.partyId})}" method="post" th:object = "${xpModifier}"><input id= "xp-submit" type = "number" th:field = "*{amount}"><button type = "submit">Add XP</button></form></td>
				<td th:text = "${onePartyPlayer?.alignment}"></td>	
				<td><form sec:authorize ="hasRole('ROLE_DM')" th:action = "@{/remove-from-party/{partyId}/{firstName} (partyId = ${party.partyId}, firstName = ${onePartyPlayer.firstName})}" method = "post"><button type = "submit">Delete From party</button></form></td>
				<!-- <td th:text = "${user.PlayerCharacter.name}"></td>
				<td th:text = "${user.PlayerCharacter.xp}"></td>
				<td th:text = "${user.PlayerCharacter.alighment}"></td>
				<td th:text = "${user.PlayerCharacter.coins}"></td> -->
				<!-- might need to add a Model object that holds all of these values or use another table side by side -->
			</tr>
		</tbody>			
		</table>
		<h1>Test</h1>
		   
			<form th:action = "@{/join-party/{partyId} (partyId = ${party.partyId})}" th:object = "${partyToBeJoined}" method = "post">
			<span th:unless = "${inParty}" th:object = "${inParty}"><button id="join-party" class = "ui-button" type = "submit" onclick = "hideButton()">Join Party</button></span>
			</form>
			
	</div>
	<div sec:authorize = "hasRole('ROLE_USER')">
		<form th:action = "@{/create-character/{partyName} (partyName = ${party.partyName})}" method = "get" th:object = "${partyToBeJoined}">
			<span th:unless = "${characterInParty}" th:object = "${characterInParty}"> <button class = "user-button" type="submit">Create Your Character</button></span>
		</form>
	</div>	
	<div>
		<form action = "/back" method = "get">
			<button class= "ui-button" type = "submit">Back To Home</button>
		</form>
	</div>
<script type = "text/javascript" src = "/js/party.js"></script>
</body>
<!--  -->
</html>