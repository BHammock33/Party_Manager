<!DOCTYPE html>
<html xmlns:th = "http://thymeleaf.org"
	  xmlns:sec = "https://ww.thymeleaf.org/extras/spring-security">
<head>
<!-- <title th:text="${party.name}"></title> -->
<title th:text ="${party.partyName}"></title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Libre+Baskerville&display=swap" rel="stylesheet">
<link rel= "stylesheet" th:href="@{/css/party.css}">

</head>
<body>

	<div class="table">
		<table>
		<thead class = "party-name">	
			<tr>
				<th class = "party-name" th:inline = "text"> [[${party.partyName}]] DM'd by [[${dm.firstName}]]<th>
			<tr>	
		</thead>
		<thead>	
			<tr>
				<th>Player</th>
				<th>Character</th>
				<th>Level</th>
				<th>Experience</th>
				<th>Change XP</th>
				<th>XP to Next Level</th>
				<th>Alignment</th>
				<th>Gold</th>
				<th>Earn/Spend</th>
				<th>Silver</th>
				<th>Earn/Spend</th>
				<th>Copper</th>
				<th>Earn/Spend</th>
				
				<th sec:authorize = "hasRole('ROLE_DM')">Remove From Party</th>
			</tr>
		</thead>
		<tbody class = "character-table">
			<tr th:each="onePartyPlayer : ${players}">
				<td th:text = "${onePartyPlayer.firstName}"></td>
			    <td th:text = "${onePartyPlayer?.characterName}"></td>
			    <td th:text = "${onePartyPlayer?.level}"></td>
				<td th:text = "${onePartyPlayer?.experience}"></td>
				<td><form th:action = "@{/add-xp/{characterName}/{partyId} (characterName = ${onePartyPlayer.characterName}, partyId = ${party.partyId})}" method="post" th:object = "${xpModifier}"><input id= "xp-submit" type = "number" th:field = "*{amount}"><button type = "submit">Add XP</button></form></td>
				<td th:text = "${onePartyPlayer?.xpToLevel}"> </td>
				<td th:text = "${onePartyPlayer?.alignment}"></td>	
				<td th:text = "${onePartyPlayer?.gold}"></td>
				<td><form th:action = "@{/add-gold/{characterName}/{partyId} (characterName = ${onePartyPlayer.characterName}, partyId = ${party.partyId})}" method="post" th:object = "${goldModifier}"><input id= "coin-submit" type = "number" th:field = "*{amount}"><button type = "submit">Earn/Spend Gold</button></form></td>
				<td th:text = "${onePartyPlayer?.silver}"></td>
				<td><form th:action = "@{/add-silver/{characterName}/{partyId} (characterName = ${onePartyPlayer.characterName}, partyId = ${party.partyId})}" method="post" th:object = "${silverModifier}"><input id= "coin-submit" type = "number" th:field = "*{amount}"><button type = "submit">Earn/Spend Silver</button></form></td>
				<td th:text = "${onePartyPlayer?.copper}"></td>
				<td><form th:action = "@{/add-copper/{characterName}/{partyId} (characterName = ${onePartyPlayer.characterName}, partyId = ${party.partyId})}" method="post" th:object = "${copperModifier}"><input id= "coin-submit" type = "number" th:field = "*{amount}"><button type = "submit">Earn/Spend Copper</button></form></td>
				
				<td><form sec:authorize ="hasRole('ROLE_DM')" th:action = "@{/remove-from-party/{partyId}/{firstName} (partyId = ${party.partyId}, firstName = ${onePartyPlayer.firstName})}" method = "post"><button type = "submit">Delete From party</button></form></td>
			</tr>
		</tbody>			
		</table>
		
		   
			<form th:action = "@{/join-party/{partyId} (partyId = ${party.partyId})}" th:object = "${partyToBeJoined}" method = "post">
			<span th:unless = "${inParty}" th:object = "${inParty}"><button id="join-party" class = "ui-button" type = "submit" onclick = "hideButton()">Join Party</button></span>
			</form>
			
	</div>
	<div sec:authorize = "hasRole('ROLE_USER')">
		<form th:action = "@{/create-character/{partyName} (partyName = ${party.partyName})}" method = "get" th:object = "${partyToBeJoined}">
			<span th:unless = "${characterInParty}" th:object = "${characterInParty}"> <button class = "user-button" type="submit">Create Your Character</button></span>
		</form>
	</div>	
	<div>
		<form action = "/back" method = "get">
			<button class= "ui-button" type = "submit">Back To Home</button>
		</form>
	</div>
<script type = "text/javascript" src = "/js/party.js"></script>
</body>
<!--  -->
</html>